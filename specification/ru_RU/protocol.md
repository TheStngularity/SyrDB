# Спецификация `SyrDB Protocol` 0.1
## `1.` Двоичный (бинарный) шаблоный
### `1.1.` Запрос
```py
Request {
    Byte     op      (1);
    Header[] headers (N);
    Content  content (N);
}
```
> ###### *Таблица `#1`*
> Название блока | Длина (байты : биты) | Тип        | Описание
> -------------- | -------------------- | ---------- | ----------------------------------
> `op`           | `1 : 8`              | `Byte`     | Тип запроса (операции, см. `3.1.`)
> `headers`      | `N : B * 8`¹         | `Header[]` | Загаловки запроса (см `2.2.`)
> `content`      | `N : B * 8`¹         | `Content`  | Содержимое запроса (см `2.3.`)

### `1.2.` Ответ
```py
Response {
    Byte     status-code (1);
    Header[] headers     (N);
    Content  content     (N);
}
```
> ###### *Таблица `#2`*
> Название блока | Длина (байты : биты) | Тип        | Описание
> -------------- | -------------------- | ---------- | ------------------------------
> `status-code`  | `1 : 8`              | `Byte`     | Код статуса ответа (см `3.2.`)
> `headers`      | `N : B * 8`¹         | `Header[]` | Загаловки ответа (см `2.2.`)
> `content`      | `N : B * 8`¹         | `Content`  | Содержимое ответа (см `2.3.`)

## `2.` Типы данных
### `2.1.` Основные типы
Все типы данного протокола взяты с [`BDSF`](https://github.com/TheStngularity/BDSF/blob/main/specification/ru_RU.md)

### `2.2.` Загаловки `запросов` и `ответов`
#### `2.2.1.` Формат загаловков
```py
Header {
    Byte   header (1);
    UInt16 length (1);
    ?      value  (N);
}
```
> ###### *Таблица `#3`*
> Название блока | Длина (байты : биты) | Тип      | Описание
> -------------- | -------------------- | -------- | ---------------------------
> `header`       | `1 : 8`              | `Byte`   | ID загаловка
> `length`       | `1 : 8`              | `UInt16` | Длина содержимого загаловка
> `value`        | `N : B * 8`¹         | `?`      | Содержимое загаловка

#### `2.2.2.` Загаловки
###### *Таблица `#4`*
Байт-код | Название        | Тип                       | З/О  | Описание
-------- | --------------- | ------------------------- | ---- | ----------------------------------
`01`     | **Provider**    | `Provider` (см. `2.2.3.`) | З    | Провайдер подключения (библиотека)
`02`     | **Version**     | `UInt16` (см. `2.2.4.`)   | З, О | Версия протокола
`03`     | **Description** | `String`                  | О    | Описание ответа
> `З` - Запрос; `О` - Ответ

#### `2.2.3.` Провайдер подключения
```py
Provider {
    String   language (N);
    String   name     (N);
    String   version  (N);
    Byte[16] id       (16);
}
```
> ###### *Таблица `#5`*
> Название блока | Длина (байты : биты) | Тип        | Описание
> -------------- | -------------------- | ---------- | ----------------------------------------------------------------------------------------------------
> `language`     | `N : B * 8`¹         | `String`   | Название языка провайдера
> `name`         | `N : B * 8`¹         | `String`   | Название провайдера
> `version`      | `N : B * 8`¹         | `String`   | Версия провайдера
> `id`           | `16 : 128`           | `Byte[16]` | ID провайдера (библиотеки)<br>Если такого нет, то `00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00`.

#### `2.2.4.` Версии протокола
###### *Таблица `#6`*
Байт    | Версия         | Описание
------- | -------------- | -----------------------------
`00 01` | `0.0.1a1.dev1` | Первая версия это базы данных

## `3.` Код статуса ответа и коды операции
### `3.1.` Коды операции
###### *Таблица `#7`*
Байт-код | Категория                                                                                                   | Описание
-------- | ----------------------------------------------------------------------------------------------------------- | ---------------------------------
`00`     | ![info](https://img.shields.io/badge/-%D0%98%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D1%8F-blue)    | Получить информацию о базе данных
`01`     | ![info](https://img.shields.io/badge/-%D0%98%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D1%8F-blue)    | Получение состояния сервера
`02`     | ![db](https://img.shields.io/badge/-%D0%91%D0%B0%D0%B7%D0%B0%20%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85-orange) | Список баз данных
`03`     | ![db](https://img.shields.io/badge/-%D0%91%D0%B0%D0%B7%D0%B0%20%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85-orange) | Создать базу данных
`04`     | ![db](https://img.shields.io/badge/-%D0%91%D0%B0%D0%B7%D0%B0%20%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85-orange) | Удалить базу данных
`05`     | ![db](https://img.shields.io/badge/-%D0%91%D0%B0%D0%B7%D0%B0%20%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85-orange) | Изменить базу данных
`06`     | ![coll](https://img.shields.io/badge/-%D0%9A%D0%BE%D0%BB%D0%BB%D0%B5%D0%BA%D1%86%D0%B8%D1%8F-yellow)        | Список коллекций
`07`     | ![coll](https://img.shields.io/badge/-%D0%9A%D0%BE%D0%BB%D0%BB%D0%B5%D0%BA%D1%86%D0%B8%D1%8F-yellow)        | Создать коллекцию
`08`     | ![coll](https://img.shields.io/badge/-%D0%9A%D0%BE%D0%BB%D0%BB%D0%B5%D0%BA%D1%86%D0%B8%D1%8F-yellow)        | Удалить коллекцию
`09`     | ![coll](https://img.shields.io/badge/-%D0%9A%D0%BE%D0%BB%D0%BB%D0%B5%D0%BA%D1%86%D0%B8%D1%8F-yellow)        | Изменить коллекцию
`0A`     | ![item](https://img.shields.io/badge/-%D0%9E%D0%B1%D1%8A%D0%B5%D0%BA%D1%82%D1%8B-brightgreen)               | Внести объект в коллекцию
`0B`     | ![item](https://img.shields.io/badge/-%D0%9E%D0%B1%D1%8A%D0%B5%D0%BA%D1%82%D1%8B-brightgreen)               | Внести множество объектов в коллекции
`0C`     | ![item](https://img.shields.io/badge/-%D0%9E%D0%B1%D1%8A%D0%B5%D0%BA%D1%82%D1%8B-brightgreen)               | Обновить объект в коллекции
`0D`     | ![item](https://img.shields.io/badge/-%D0%9E%D0%B1%D1%8A%D0%B5%D0%BA%D1%82%D1%8B-brightgreen)               | Обновить множество объектов в коллекции
`0F`     | ![item](https://img.shields.io/badge/-%D0%9E%D0%B1%D1%8A%D0%B5%D0%BA%D1%82%D1%8B-brightgreen)               | Удалить объект из коллекции
`10`     | ![item](https://img.shields.io/badge/-%D0%9E%D0%B1%D1%8A%D0%B5%D0%BA%D1%82%D1%8B-brightgreen)               | Удалить множество объектов из коллекции
`11`     | ![server](https://img.shields.io/badge/-%D0%A1%D0%B5%D1%80%D0%B2%D0%B5%D1%80-lightgrey)                     | Обновить сервер (если есть обновления)

### `3.2.` Статус коды
###### *Таблица `#8`*
Байт-код | Категория                                                                                                                   | Описание
-------- | --------------------------------------------------------------------------------------------------------------------------- | --------------------------
`00`     | ![success](https://img.shields.io/badge/-%D0%A3%D1%81%D0%BF%D0%B5%D1%85-green)                                              | Операция выполнена успешно
`01`     | ![err](https://img.shields.io/badge/-%D0%9E%D1%88%D0%B8%D0%B1%D0%BA%D0%B0%20(%D0%A1%D0%B5%D1%80%D0%B2%D0%B5%D1%80)-red)     | Неизвестная ошибка
`02`     | ![err](https://img.shields.io/badge/-%D0%9E%D1%88%D0%B8%D0%B1%D0%BA%D0%B0%20(%D0%A1%D0%B5%D1%80%D0%B2%D0%B5%D1%80)-red)     | Файл базы данных недоступен
`03`     | ![cerr](https://img.shields.io/badge/-%D0%9E%D1%88%D0%B8%D0%B1%D0%BA%D0%B0%20(%D0%9A%D0%BB%D0%B8%D0%B5%D0%BD%D1%82)-orange) | Авторизация не пройдена
`04`     | ![cerr](https://img.shields.io/badge/-%D0%9E%D1%88%D0%B8%D0%B1%D0%BA%D0%B0%20(%D0%9A%D0%BB%D0%B8%D0%B5%D0%BD%D1%82)-orange) | Недостаточно прав
`05`     | ![cerr](https://img.shields.io/badge/-%D0%9E%D1%88%D0%B8%D0%B1%D0%BA%D0%B0%20(%D0%9A%D0%BB%D0%B8%D0%B5%D0%BD%D1%82)-orange) | У вас нет доступа к этой базе данных
`06`     | ![cerr](https://img.shields.io/badge/-%D0%9E%D1%88%D0%B8%D0%B1%D0%BA%D0%B0%20(%D0%9A%D0%BB%D0%B8%D0%B5%D0%BD%D1%82)-orange) | Недостаточно аргументов
`07`     | ![cerr](https://img.shields.io/badge/-%D0%9E%D1%88%D0%B8%D0%B1%D0%BA%D0%B0%20(%D0%9A%D0%BB%D0%B8%D0%B5%D0%BD%D1%82)-orange) | Неверный тип аргумента

---
- ¹ - `N` = любое число; `B` = кол-во байт.
